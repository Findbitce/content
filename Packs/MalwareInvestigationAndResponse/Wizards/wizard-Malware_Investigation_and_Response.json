{
    "id": "Malware Use Case Adoption Wizard",
    "version": -1,
    "modified": "2022-04-10T11:55:54.250933+03:00",
    "fromVersion": "6.9.0",
    "name": "Malware Use Case Adoption Wizard",
    "description": "### Manually Configure Your Use Case\nFor manual configuration, it is recommended to configure your integration instance to use: \n- The primary **playbook**: [Malware Investigation and Response Incident Handler](https://xsoar.pan.dev/docs/reference/playbooks/malware-investigation--response-incident-handler) (Available from version 6.5)\n- The primary **incident type**: **Malware Investigation and Response** (Available from version 6.5)\n\n#### Fetch Data from an EDR integration\n1. In [MarketPlace](https://xsoar.pan.dev/marketplace), select a fetching integration (for more details on supported EDR integrations, check the [Endpoint Integrations](#endpoint-integrations) section):  \n   1. PaloAlto Cortex XDR \n   2. Microsoft Defender For Endpoint\n   3. CrowdStrike Falcon  \n2. In the **Settings** > **Integrations** tab, configure your fetching integration instance.   \n###### CrowdStrike Falcon & Microsoft Defender For Endpoint\n| **Setting**     | **Value**                              | \n|-----------------|----------------------------------------|\n| Fetch Incidents | **true**                               |\n| Incident Type   | **Malware Investigation and Response** |\n| Classifier      | **null**                               |\n###### Cortex XDR by Palo Alto Networks\n| **Setting**     | **Value**                                    | \n|-----------------|----------------------------------------------|\n| Fetch Incidents | **true**                                     |\n| Incident Type   | **null**                                     |\n| Classifier      | **Cortex XDR Incident Handler - Classifier** |\n3. **Review the master playbook inputs**. These inputs control key features in the investigation process.\n\n#### Fetch Data from a SIEM\nIf you prefer fetching incidents using a SIEM integration, you need to perform the following steps.  \n  \n1. **Before you start:** Set up your relevant EDR integration. For more details on supported EDR integrations, check the [Endpoint Integrations](#endpoint-integrations) section.\n2. Through your SIEM integration mapper, map the following fields to retrieve all required information:  \n   - Original alert ID mapped to the `External System ID` incident field.\n   - Incident type mapped to the `External Category Name` incident field. For example, in CrowdStrike you have two different types - Detections and Incidents.\n   \n   If you do not want to update your current mapper, change the following playbook inputs to the preferred `Alert ID` and the `Incident Type` incident fields in the master playbook ([Malware Investigation and Response Incident Handler](https://xsoar.pan.dev/docs/reference/playbooks/malware-investigation--response-incident-handler)):\n     - `SIEMincidentFieldForID`  \n     - `SIEMincidentFieldForType` \n3. Validate the relevant EDR integration is enabled.\n4. Ensure the relevant incoming incidents are assigned the 'Malware Investigation And Response' incident type (through the SIEM Classifier).\n\n### Additional Integrations\n#### [Mitre ATT&CK](https://xsoar.pan.dev/marketplace/details/FeedMitreAttackv2) (Optional but highly recommended)\nThe Mitre Att&ck integration enables easy classification for investigated incidents and better understanding of the current stage in the kill chain phase. The Mitre Att&ck integration ingests enriched information about the found techniques associated with the incident.  \nInformation on findings are presented in the layout in the **Investigation Summary** and **Detailed Investigation** sections.  \n\nYou need to **enable** this integration (you can optionally enable the fetching setting in advance).\n\nRelated Playbook: [Mitre Attack - Extract Technique Information From ID](https://xsoar.pan.dev/docs/reference/playbooks/mitre-attack---extract-technique-information-from-id)\n\n### Sandbox Integrations\n#### [Palo Alto Networks WildFire](https://xsoar.pan.dev/marketplace/details/Palo_Alto_Networks_WildFire) (Optional)\nThe Palo Alto Networks Wildfire sandbox integration enables you to automatically identify unknown threats by detonating unknown files. It also stops attacks by dynamically analyzing files.\n\n#### [CrowdStrike FalconX](https://xsoar.pan.dev/marketplace/details/CrowdStrikeFalconX) (Optional)\nThe CrowdStrike FalconX sandbox integration enables you to automatically identify unknown threats by detonating unknown files and retrieving report information. It also stops attacks by dynamically analyzing files.  \n\n#### [Joe Security](https://cortex.marketplace.pan.dev/marketplace/details/JoeSecurity) (Optional)\nThe Joe Security sandbox integration enables you to automatically identify unknown threats by detonating unknown files and retrieving report information. It also stops attacks by dynamically analyzing files.\n\n### Ticketing Systems  \n\nAs part of the True positive flow, the True Positive Incident Handling playbooks (each vendor has its own) enable opening tickets in relevant IT ticketing systems to re-image affected hosts.\nThe inputs that enable using ticketing systems are specified in the main **Malware Investigation & Response Incident Handler** playbook (TicketingSystemToUse and TicketProjectName). The ticket description is derived from the confirmation whether a true/false positive task exists for each of the EDR vendor-specific playbooks.\n\n#### [ServiceNow](https://xsoar.pan.dev/marketplace/details/ServiceNow) (Optional)\nThe ServiceNow integration enables creating and managing tickets in ServiceNow.\n\n#### [Jira](https://xsoar.pan.dev/marketplace/details/Jira) (Optional)\nThe Jira integration enables creating and managing tickets in Jira.\n\n## Layouts\n\n* **Incident info**    \nThis tab provides an overview for the incident and easy remediation actions to be performed by the analyst.  \n\n  ![Incident info tab](../../../docs/doc_imgs/reference/MalwareInvestigationAndResponse/Malware_Investigation_And_Response_layout1.png)\n\n* **Investigation**   \nThis tab dives into the investigation process, providing details such as enriched information about indicators and alerts.  \n\n  ![Investigation tab](../../../docs/doc_imgs/reference/MalwareInvestigationAndResponse/Malware_Investigation_And_Response_layout2.png)\n\n* **Forensics**     \nThis tab provides forensics information collected from the endpoint. Here you can check the Process list and Netstat information collected from the investigated endpoint.\n\n  ![Forensics](../../../docs/doc_imgs/reference/MalwareInvestigationAndResponse/Malware_Investigation_And_Response_layout3.png)\n\n\n### Layout Feature Support Summary\n\nThe primary layout is the standard and common layout for all supported vendors, however certain features are not available for some vendors. The table below summarizes the support for each vendor per layout feature.\n\n| **Type**                  | **Name**                         | **Microsoft Defender For Endpoint** | **CrowdStrike Falcon**      | **Cortex XDR**              | \n|------------------------------|-------------------------------------|-------------------------------------|-----------------------------|-------------------------------|\n| Button                       | **Kill Process**                    |                   :x:                 | :white_check_mark:*                                     |  :white_check_mark:**                                   |\n| Button                       | **Delete file**                      |                   :white_check_mark:                 |               :white_check_mark:                         |               :white_check_mark:                          |\n| Button                       | **Isolate** / **Unisolate endpoint**       |                   :white_check_mark:                 |               :white_check_mark:                          |              :white_check_mark:                          |\n| Dynamic Section              | **Disable Account in IDP**      |                   :white_check_mark:                  |              :white_check_mark:                          |             :white_check_mark:                       |\n| Dynamic Section              | **Process List**             |                   :x:                 |               :white_check_mark:                         |               :white_check_mark:                         |\n| Dynamic Section              | **Netstat Information**      |                   :x:                |              :white_check_mark:                          |               :x:                       |\n\n*Only supports 'file path'  \n**Only supports 'file name'   \n\n## Endpoint Integrations  \nCreate integration instances from the following content packs.",
    "dependency_packs": [
      {
        "name": "Endpoint Detection & Response",
        "min_required": 1,
        "packs": [
          {
            "name": "CrowdStrikeFalcon",
            "display_name": "CrowdStrike Falcon"
          },
          {
            "name": "MicrosoftDefenderAdvancedThreatProtection",
            "display_name": "Microsoft Defender for Endpoint"
          },
          {
            "name": "CortexXDR",
            "display_name": "Palo Alto Networks Cortex XDR - Investigation and Response"
          }
        ]
      },
      {
        "name": "Sandbox",
        "min_required": 0,
        "packs": [
          {
            "name": "Palo_Alto_Networks_WildFire",
            "display_name": "Palo Alto Networks WildFire"
          },
          {
            "name": "CrowdStrikeFalconX",
            "display_name": "CrowdStrike Falcon X"
          },
          {
            "name": "JoeSecurity",
            "display_name": "Joe Security"
          }
        ]
      },
      {
        "name": "Messaging",
        "min_required": 0,
        "packs": [
          {
            "name": "MicrosoftExchangeOnPremise",
            "display_name": "Microsoft Exchange On-Premise"
          },
          {
            "name": "Gmail",
            "display_name": "Gmail"
          },
          {
            "name": "MicrosoftGraphMail",
            "display_name": "Microsoft Graph Mail"
          }
        ]
      },
      {
        "name": "Case Management",
        "min_required": 0,
        "packs": [
          {
            "name": "Jira",
            "display_name": "Atlassian Jira v2"
          },
          {
            "name": "ServiceNow",
            "display_name": "ServiceNow v2"
          }
        ]
      },
      {
        "name": "Data Enrichment & Threat Intelligence",
        "min_required": 0,
        "packs": [
          {
            "name": "AutoFocus",
            "display_name": "Palo Alto Networks AutoFocus"
          },
          {
            "name": "VirusTotal",
            "display_name": "VirusTotal"
          },
          {
            "name": "FeedMitreAttackv2",
            "display_name": "Mitre Attack v2"
          }
        ]
      }
    ],
    "wizard": {
      "fetching_integrations": [
        {
          "priority": 3,
          "name": "Microsoft Defender Advanced Threat Protection",
          "action": {
            "existing": "Update your current instance to work with the new Malware Investigation and Response incident type: \n1. Enable fetching. \n2. Set the Incident type field to Malware Investigation and Response. \n3. Set the Mapper field to 'Microsoft Defender For Endpoint Mapper'. \n4. Check the 'Fetch alert evidence' option.",
            "new": "Set up new 'Microsoft Defender Advanced Threat Protection' instance to start fetching Malware Investigation and Response incidents: \n1. Enable fetching. \n2. Set the Incident type field to Malware Investigation and Response. \n3. Set the Mapper field to 'Microsoft Defender For Endpoint Mapper'. \n4. Check the 'Fetch alert evidence' option."
          },
          "description": "Set up the 'Microsoft Defender for Endpoint' integration to work with your Malware Investigation and Response use case.",
          "incident_type": "Malware Investigation and Response"
        },
        {
          "priority": 2,
          "name": "CrowdstrikeFalcon",
          "action": {
            "existing": "Update your current instance to work with the new Malware incident type: \n1. Enable fetching. \n2. Remove the default Classifier.  \n3. Set the Incident type field to Malware Investigation and Response. \n4. Set the Mapper field to 'CrowdStrike Falcon Mapper'.",
            "new": "Set up new 'Crowdstrike Falcon' instance to start fetching Malware Investigation and Response incidents: \n1. Enable fetching.\n2. Remove the default Classifier. \n3. Set the Incident type field to Malware Investigation and Response. \n4. Set the Mapper field to 'CrowdStrike Falcon Mapper'."
          },
          "description": "Set up the 'Crowdstrike Falcon' integration to work with your Malware Investigation and Response use case.",
          "incident_type": "Malware Investigation and Response"
        },
        {
          "priority": 1,
          "name": "Cortex XDR - IR",
          "action": {
            "existing": "Update your current instance to work with the new Malware Investigation and Response incident type: \n1. Enable fetching. \n2. Set the 'Cortex XDR Incident Handler - Classifier'.\n3. Set the Incident type field to 'Malware Investigation and Response' (the XDR classifier will keep on routing other incident types).\n4. Set the Mapper field to 'XDR - Incoming Mapper'.",
            "new": "Set up new 'Cortex XDR - IR' instance to work with the Malware Investigation and Response incident type: \n1. Turn on fetching. \n2. Choose the 'Cortex XDR Incident Handler - Classifier .\n3. Set the Incident type field to 'Malware Investigation and Response' (the XDR classifier will keep on routing other incident types).\n4. Set the Mapper field to 'XDR - Incoming Mapper'."
          },
          "description": "Set up the 'Cortex XDR - IR' integration to work with your Malware Investigation and Response use case.",
          "incident_type": "Malware Investigation and Response"
        }
      ],
      "set_playbook": [
        {
          "name": "Malware Investigation & Response Incident Handler"
        }
      ],
      "supporting_integrations": [
        {
          "name": "WildFire-v2",
          "action": {
            "existing": "Configure 'Wildfire' to enable file detonation to improve investigation.",
            "new": "Configure 'Wildfire' to enable file detonation to improve investigation."
          },
          "description": "Configure Wildfire to enable file detonation to improve investigation."
        },
        {
          "name": "CrowdStrike Falcon X",
          "action": {
            "existing": "Configure 'CrowdStrike Falcon X' to enable file detonation to improve investigation.",
            "new": "Configure 'CrowdStrike Falcon X' to enable file detonation to improve investigation."
          },
          "description": "Configure 'CrowdStrike Falcon X' to enable file detonation to improve investigation."
        },
        {
          "name": "JoeSecurityV2",
          "action": {
            "existing": "Configure 'Joe Security V2' to enable file detonation to improve investigation.",
            "new": "Configure 'Joe Security V2' to enable file detonation to improve investigation."
          },
          "description": "Configure 'Joe Security V2' to enable file detonation to improve investigation."
        },
        {
          "name": "Gmail",
          "action": {
            "existing": "Configure 'Gmail' to enable email notifications.",
            "new": "Configure Gmail to enable email notifications."
          },
          "description": "Configure Gmail to enable email notifications."
        },
        {
          "name": "EWSO365",
          "action": {
            "existing": "Configure 'EWS O365' to enable email notifications.",
            "new": "Configure EWSO365 to enable email notifications."
          },
          "description": "Configure EWSO365 to enable email notifications."
        },
        {
          "name": "MicrosoftGraphMail",
          "action": {
            "existing": "Configure 'Microsoft Graph Mail' to enable email notifications.",
            "new": "Configure 'Microsoft Graph Mail' to enable email notifications."
          },
          "description": "Configure Microsoft Graph Mail to enable email notifications."
        },
        {
          "name": "ServiceNow v2",
          "action": {
            "existing": "Configure 'ServiceNow v2' to open a ticket for a true positive incident.",
            "new": "Configure 'ServiceNow v2' to open a ticket for a true positive incident."
          },
          "description": "Configure 'ServiceNow v2' to open a ticket for a true positive incident."
        },
        {
        "name": "jira-v2",
        "action": {
          "existing": "Configure 'jira-v2' to open a ticket for a true positive incident.",
          "new": "Configure 'jira-v2' to open a ticket for a true positive incident."
          },
        "description": "Configure 'ServiceNow v2' to open a ticket for a true positive incident."
        },
        {
        "name": "AutoFocus V2",
        "action": {
          "existing": "Configure 'Palo Alto Networks AutoFocus v2' to enrich IOCs as part of the investigation.",
          "new": "Configure 'Palo Alto Networks AutoFocus v2' to enrich IOCs as part of the investigation."
          },
        "description": "Configure 'Palo Alto Networks AutoFocus v2' to enrich IOCs as part of the investigation."
        },
        {
        "name": "VirusTotal (API v3)",
        "action": {
          "existing": "Configure 'VirusTotal (API v3)' to enrich IOCs as part of the investigation.",
          "new": "Configure 'VirusTotal (API v3)' to enrich IOCs as part of the investigation."
          },
        "description": "Configure 'VirusTotal (API v3)' to enrich IOCs as part of the investigation."
        },
        {
        "name": "MITRE ATT&CK v2",
        "action": {
          "existing": "Configure 'MITRE ATT&CK v2' to enrich IOCs as part of the investigation.",
          "new": "Configure 'MITRE ATT&CK v2' to enrich IOCs as part of the investigation."
          },
        "description": "Configure 'MITRE ATT&CK v2' to enrich IOCs as part of the investigation."
        }
      ],
      "next": [
        {
          "name": "Enable Your Use Case",
          "action": {
            "existing": "Enable the fetching integrations to start ingesting data and run the playbook.",
            "new": "Enable the fetching integrations to start ingesting data and run the playbook."
          }
        }
      ]
    }
  }
  
